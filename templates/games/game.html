{% extends "base.html" %}
{% block title %}éŠæˆ²{% endblock %}
{% block head %}
<meta name="csrf-token" content="{{ csrf_token }}">
{% endblock %}
{% block content %}
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/game.css' %}">
<div id="app">
    <div>
      <p class="note">Tap/Click around to move</p>
      <!-- å³ä¸Šæ–¹çš„é»‘é»‘å€å¡Š -->
      <div class="note" id="status-box" 
        style="
          left: auto;
          right: 5%;
          top: 6vh;
          background-color: rgba(0, 0, 0, 0.6);
          padding: 10px 14px;
          border-radius: 10px;
          max-width: 260px;
          text-align: right;
          font-size: 14px;
          line-height: 1.5;
          box-shadow: 0 0 6px rgba(0, 0, 0, 0.3);
          z-index: 10;">
        <div id="remaining-cracks">å‰©é¤˜è£‚ç¸«æ•¸ï¼š3</div>
        <div id="game-hint">ğŸ’¡æç¤ºï¼šé è¿‘ç´…è‰²è£‚ç¸«é–‹å§‹ä¿®è£œ</div>
      </div>

      <div id="textbox-container" style="display: none">
        <div id="textbox">
          <p id="dialogue" class="ui-text"></p>
      
          <!-- é¡Œç›®å…§å®¹æ”¾é€™è£¡ -->
          <div id="question-box" style="display: none">
            <p id="question-text" class="ui-text"></p>
      
            <!-- ç´…é¡Œ -->
            <div id="red-choices" style="display: none;">
              <button id="option1"></button>
              <button id="option2"></button>
              <button id="option3"></button>
              <button id="option4"></button>
            </div>
      
            <!-- è—é¡Œ -->
            <div id="blue-answer" style="display: none;">
              <input type="text" id="blue-input" placeholder="è«‹è¼¸å…¥ç­”æ¡ˆ" />
              <button id="blue-submit">é€å‡º</button>
            </div>
      
            <!-- é¡¯ç¤ºç­”å°/éŒ¯ -->
            <p id="feedback" style="display:none;"></p>
          </div>
      
          <div class="btn-container">
            <button id="close" class="ui-close-btn">Close</button>
          </div>
        </div>
      </div>      
    </div>
    <!-- éå ´å½±ç‰‡ï¼ˆä¸€é–‹å§‹éš±è—ï¼‰ -->
    <div id="cutscene-container" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: black;">
      <video id="cutscene-video" autoplay muted playsinline style="width: 100%; height: 100%; object-fit: cover;"></video>
    </div>    
    <canvas id="gameCanvas"></canvas>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="module">
  import kaboom from "https://unpkg.com/kaboom@3000.1.17/dist/kaboom.mjs";
  window.k = kaboom({
      global: false,
      touchToMouse: true,
      canvas: document.getElementById("gameCanvas"),
      debug: false,
  });
</script>
<script type="module" src="{% static 'js/kaboomCtx.js' %}"></script>
<script type="module" src="{% static 'js/game.js' %}"></script>
{% endblock %}